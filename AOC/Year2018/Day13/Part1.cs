using System;
using System.Linq;
using System.Security.Cryptography;
using System.Text;

namespace AoC.Year2018.Day13
{
    public class Part1 : BasePart
    {
        protected void RunScenario(string title, string input)
        {
            RunScenario(title, () =>
            {
                var lines = input.Split(new[] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries);
                var h = lines.Length;
                var w = lines.Max(i => i.Length);

                var track = lines.Select(i => i.Select(MapTrack).ToArray()).ToArray();
                var carts = lines.SelectMany((i, y) => i.Select((ii, x) => new
                {
                    X = x,
                    Y = y,
                    Dir = MapCart(ii),
                })).Where(i => i.Dir.HasValue).Select(i => new Cart
                {
                    X = i.X,
                    Y = i.Y,
                    Dir = i.Dir.Value,
                }).ToArray();

                for (var t = 0; ; t++)
                {
                    var toProcess = carts.OrderBy(i => i.Y).ThenBy(i => i.X).ToArray();
                    foreach (var cart in toProcess)
                    {
                        UpdatePosition(cart);
                        UpdateDirection(cart, track);
                        if (carts.Any(i => i.X == cart.X && i.Y == cart.Y && i != cart))
                        {
                            Console.WriteLine($"{cart.X}, {cart.Y} => {t}");
                            return;
                        }
                    }

                    //var sb = new StringBuilder();
                    //for (var y = 0; y < h; y++)
                    //{
                    //    for (var x = 0; x < w; x++)
                    //    {
                    //        var cart = carts.FirstOrDefault(i => i.X == x && i.Y == y);
                    //        if (null == cart)
                    //        {
                    //            sb.Append(MapTrack(track[y][x]));
                    //        }
                    //        else
                    //        {
                    //            sb.Append(MapCart(cart));
                    //        }
                    //    }

                    //    sb.AppendLine();
                    //}
                    //Console.WriteLine(sb.ToString());
                    //Console.ReadLine();
                }
            });
        }

        private char MapTrack(TrackDir track)
        {
            switch (track)
            {
                case TrackDir.BackSlash: return '\\';
                case TrackDir.Cross: return '+';
                case TrackDir.FwdSlash: return '/';
                case TrackDir.None: return ' ';
                case TrackDir.Straight: return '|';
            }

            throw new Exception("Bad track direction");
        }

        private char MapCart(Cart cart)
        {
            if (cart.IsCrashed) return 'X';
            switch (cart.Dir)
            {
                case CartDir.Down: return 'v';
                case CartDir.Right: return '>';
                case CartDir.Left: return '<';
                case CartDir.Up: return '^';
            }

            throw new Exception("Bad track direction");
        }

        private TrackDir MapTrack(char input)
        {
            switch (input)
            {
                case ' ': return TrackDir.None;
                case '+': return TrackDir.Cross;
                case '|':
                case '-':
                case '<':
                case '>':
                case '^':
                case 'v':
                    return TrackDir.Straight;
                case '\\': return TrackDir.BackSlash;
                case '/': return TrackDir.FwdSlash;
            }

            throw new Exception($"Bad direction: {input}");
        }

        private CartDir? MapCart(char input)
        {
            switch (input)
            {
                case '<': return CartDir.Left;
                case '>': return CartDir.Right;
                case '^': return CartDir.Up;
                case 'v': return CartDir.Down;
            }
            return null;
        }

        private void UpdatePosition(Cart cart)
        {
            switch (cart.Dir)
            {
                case CartDir.Down:
                    cart.Y++;
                    break;
                case CartDir.Up:
                    cart.Y--;
                    break;
                case CartDir.Left:
                    cart.X--;
                    break;
                case CartDir.Right:
                    cart.X++;
                    break;
            }
        }

        private void UpdateDirection(Cart cart, TrackDir[][] tracks)
        {
            var track = tracks[cart.Y][cart.X];
            switch (track)
            {
                case TrackDir.None: throw new Exception("Cart off the rails");
                case TrackDir.Straight: break;
                case TrackDir.Cross:
                    cart.NextCrossDirection = (cart.NextCrossDirection + 1) % 3;
                    switch (cart.NextCrossDirection)
                    {
                        case 1: // left
                            cart.Dir = (CartDir)(((int)cart.Dir + 3) % 4);
                            break;
                        case 0: // right
                            cart.Dir = (CartDir)(((int)cart.Dir + 1) % 4);
                            break;
                    }
                    break;
                case TrackDir.BackSlash:
                    switch (cart.Dir)
                    {
                        case CartDir.Down:
                            cart.Dir = CartDir.Right;
                            break;
                        case CartDir.Up:
                            cart.Dir = CartDir.Left;
                            break;
                        case CartDir.Right:
                            cart.Dir = CartDir.Down;
                            break;
                        case CartDir.Left:
                            cart.Dir = CartDir.Up;
                            break;
                    }
                    break;
                case TrackDir.FwdSlash:
                    switch (cart.Dir)
                    {
                        case CartDir.Down:
                            cart.Dir = CartDir.Left;
                            break;
                        case CartDir.Up:
                            cart.Dir = CartDir.Right;
                            break;
                        case CartDir.Right:
                            cart.Dir = CartDir.Up;
                            break;
                        case CartDir.Left:
                            cart.Dir = CartDir.Down;
                            break;
                    }
                    break;
            }
        }


        private enum TrackDir
        {
            None = 0,
            Straight = 1,
            Cross = 2,
            BackSlash = 3,
            FwdSlash = 4,
        }

        private class Cart
        {
            public int X;
            public int Y;
            public CartDir Dir;
            public int NextCrossDirection = 0;
            public bool IsCrashed = false;
        }

        private enum CartDir
        {
            Up = 0,
            Right = 1,
            Down = 2,
            Left = 3,
        }

        public override void Run()
        {
            RunScenario("initial", @"/->-\        
|   |  /----\
| /-+--+-\  |
| | |  | v  |
\-+-/  \-+--/
  \------/   ");
            //return;
            RunScenario("part1", @"                 /-----------------------------\                                             /-------------------------------\                        
       /---------+-----------------------------+---------------------------------------------+--------------------\          |                        
       |         |            /----------------+------------------------------------------\  |                    |          |                        
       |         |            |                |                          /---------------+--+--------------\     |          |                        
       |         |            |  /-------------+-------------\            |               |  |              |     |          |                        
       |         |            |  |             |         /->-+------------+---------------+--+------------\ |     |          |                        
   /---+---------+----------\ |  |             |         |   |   /--------+---------------+--+----------\ | |     |         /+-------------------\    
   |   |         |          | |  |            /+---------+---+---+------<-+---------------+--+---------\| | |  /--+---------++---------------\   |    
   |   |    /----+--------<-+-+--+------------++---------+---+---+--------+---------------+--+---------++-+-+--+--+-\       ||               |   |    
   |   |    |    | /--------+-+--+---------\  ||         |   |   |        |     /---------+--+-\      /++-+-+--+-\| |       ||               |   |    
/--+---+----+----+-+--------+-+--+---------+--++---------+---+---+--------+-----+---------+--+-+-----\||| | |  | || |       ||               |   |    
|  |   |    |    | |    /---+-+--+---------+-\||      /--+---+---+--------+-----+---------+--+-+-----++++-+\|  | || |       ||               |   |    
|  |   |   /+----+-+----+--\|/+--+---------+-+++------+\ |   |   |        |     |         |  | |     |||| |||  | || |       ||               |   |    
|  |   |   ||    | |    |  ||||  |         | |||      || |   |   |        |     |      /--+--+-+-----++++-+++--+-++-+------\||               |   |    
|  |   |   ||    | |    |  ||||  |    /----+-+++------++-+---+---+--------+-----+------+--+--+-+-----++++-+++--+-++-+------+++-----------\   |   |    
|  |   |   ||    | |   /+--++++--+----+----+-+++-\    || |   |   |        |     |      |  |  | |     |||| |||  | || |      |||           |   |   |    
|  |   |   ||    \-+---++--++++--+----+----+-++/ |    || |   |   |        |     |      |  |  | |     |||| |||  | || |      |||           |   |   |    
|  |   |   ||      |   ||  ||||  |    |    | ||  | /--++-+---+---+--------+-----+------+\ |  | |     |||| |||  | || |      |||           |   |   |    
|  |   |   ||      |   ||  ||||  |    |    | ||  | |  || |   |   |        \-----+------++-+--+-+-----++++-++/  | || |      |||           |   |   |    
|  |   |   ||      |   ||  ||||  |    |    | ||  | |/-++-+---+---+--------------+------++-+--+-+-----++++-++---+\|| |      |||           |   |   |    
|  |   |   ||      |   |\--++++--+----+----+-/|  | || || |   |   |              |      || |/-+-+-----++++-++---++++-+------+++-----------+---+---+---\
|  |   |   ||      |   |   ||||/-+----+----+--+--+-++-++-+---+---+--------------+------++-++-+-+-----++++-++---++++-+---\  |||           |   |   |   |
|  |   |   ||      |   |   ||||| |    |    |  |  | || || |   |   |              |      || || \-+-----++++-++---++++-+---+--++/           |   |   |   |
|  \---+---++------+---+---+/||| | /--+----+--+--+-++-++\|   |   |         /----+------++-++---+-----++++-++---++++-+---+--++------------+---+\  |   |
|     /+---++------+---+---+-+++-+-+--+--\ |  |  | || ||||   |   |  /------+----+-\    || ||   |     |||| ||   |||| |   |  ||  /---------+---++--+-\ |
|     ||   ||      |   |   | \++-+-+--+--+-+--+--+-++-+/||/--+---+--+------+----+-+----++-++---+-----++++-++---++++-+---+--++--+---------+\  ||  | | |
|     ||   ||      |   |   |  || | |  |  | |  |  | || | |||  |   |  |/-----+----+-+----++-++---+-----++++-++---++++-+---+\ ||  |         ||  ||  | | |
|     ||   ||      |   \---+--++-+-+--+--+-+--+--/ || | |||  |   |  ||     |    | |    || ||   |     |||| ||   |||| |   || ||  |         ||  ||  | | |
\-----++---++------+-------+--++-+-+--+--+-+--+----++-+-+++--+---+--++-----+----+-+----++-++---+-----/||| ||   |||| |   || ||  |         ||  ||  | | |
      ||   ||      |       |  || |/+--+--+-+--+----++-+-+++--+---+--++\    |    | |/---++-++---+------+++-++\  |||| |   || ||  |         ||  ||  | | |
      ||   ||      |       |  || |||  |  | |  |    || | |||  |   |  |||    |    | ||   || ||   |      ||| |||  |||| |   || ||  |         ||  ||  | | |
      ||   ||      |       |  || |||  |  | |  |/---++-+-+++--+---+--+++----+\   | ||   || ||   |      ||| |||  |||| |   || ||  |         ||  ||  | | |
      ||   ||      |       |  || |||  |  | |  ||   || | |||  |   |  |||    ||   | || /-++-++---+------+++-+++--++++-+---++-++--+--------\||  ||  | | |
      ||   \+------+-------/  || |||  |  | |  ||   || | |||  |  /+--+++----++---+-++-+-++-++---+------+++\|||  |||| |   || |\--+--------+++--++--/ | |
 /----++----+------+---\      \+-+++--+--+-+--++---++-+-+++--+--++--+++----++---+-++-+-++-/|   |      |||||||  |||| |   || |   |        |||  ||    | |
 |    || /--+------+---+----\  | |||  |  | |/-++---++-+-+++--+--++--+++\   || /-+-++-+-++--+---+------+++++++--++++-+---++-+---+--------+++\ ||    | |
 |    || |  |  /---+---+----+--+-+++--+--+-++-++--\|| | |||  |  ||  ||||/--++-+-+-++-+-++--+---+------+++++++--++++-+---++-+---+--------++++-++---\| |
 |    || |  |  |   |   |    |  | |||  |  | |v ||  ||| | |||  |  ||  |||||  \+-+-+-++-+-++--+---+------+++++++--++++-+---++-+---+--------++++-+/   || |
 |    || |  |  |   |   |    |  | |||  |  | || || /+++-+-+++--+--++--+++++---+-+-+-++-+-++--+---+------+++++++--++++-+---++-+---+---\    |||| |    || |
 |    || |  |  |   \---+----+--+-+++--+--+-/| || |||| | |\+--+--++--+++++---+-+-+-++-+-++--+---+------++++/||  |||| |   || |   |   |    |||| |    || |
 |    || |  |  |/------+-\  |  | |||  | /+--+-++-++++-+-+-+--+--++--+++++---+-+-+-++-+-++--+---+------++++-++-\|||| |   || |   |   |    |||| |    || |
 | /--++-+--+--++------+\|  |  | |||  |/++--+-++-++++-+-+\|  |  ||  |||||   | | | |\-+-++--+---+------++++-+/ ||||| |   || |  /+---+----++++-+----++\|
/+-+--++-+--+\ ||      |||  |  \-+++--++++--+-++-++++-+-+++--+--++--+++++---+-+-+-+--+-++--+---+------++++-+--+++++-+---/| |  ||   | /--++++-+--\ ||||
|| |  ||/+--++-++------+++--+---\|||  ||||  | || |||| | |||  |  ||  |||||   | | \-+--+-++--+---/      |||| |  ||||| |    | |  ||   | |  |||| |  | ||||
|| |  ||||  || ||      |||  |   ||||  ||||  | || |||| \-+++--+--++--+++++---+-+---+--+-++--+----------++++-/  ||||| |    | |  ||   | |  |||| |  | ||||
|| |  v|||  || ||  /---+++--+---++++--++++--+-++-++++---+++--+--++--+++++---+-+---+--+-++--+-------\  ||||    ||||| |    | |  ||   | |  |||| |  | ||||
|| |  ||||  || ||  |   |||  |   ||||  ||||  | || ||||   |||  |/-++--+++++---+-+---+--+-++--+\      |  ||||    |\+++-+----+-+--++---+-+--++++-/  | ||||
|| |  ||||  || ||  |   |||  |  /++++--++++--+-++-++++---+++--++-++--+++++---+-+---+--+-++--++----\ |  ||||    | ||| |    | |  ||   | |  ||||    | ||||
|| |  ||||  || ||  |   |||  |  ||||| /++++--+-++-++++---+++--++-++--+++++---+-+---+--+-++--++----+-+--++++----+-+++-+----+-+--++---+-+--++++----+\||||
|| |  ||||  || ||  |   |||  |  ||||| |||||  | || |||\---+++--++-++--+++++---+-+---+--+-++--++----+-+--++++----+-/|| |    | |  ||   | |  ||||    ||||||
|| |  ||||  || ||  |   |||  |  ||||| |||||  | ||/+++----+++--++-++--+++++---+-+---+--+-++--++----+-+--++++----+--++-+----+-+--++---+-+--++++\   ||||||
|| |  ||||  || ||  |   |||  |  ||||| |||||  | ||||||    |||  || ||  |||||   | |   |  | ||  ||    | |  ||||    |  || |    | |  ||   | |  |||||   ||||||
|| |  ||||  || ||  |   |||  |  |||||/+++++--+-++++++----+++--++-++--+++++---+-+---+--+-++--++----+-+--++++----+\ || |    | |  ||   | |  |||||   ||||||
|| |  |\++--++-++--+---+++--+--+++++++++++--+-++++++----+++--++-++--+++++---+-+---+--+-++--++----+-+--++++----++-+/ |    | |  ||   | |  |||||   ||||||
|| |  | ||  || ||  |   |||  |  |||||||||||  |/++++++----+++--++-++-\|||||   | |   |  | ||  ||    | |  ||||    || |  |    | |  ||   | |  |||||   ||||||
|| |  | ||  || ||  |   |||  |  ||||\++++++--++++++++----/||  || || ||||||   | |   |  | ||  ||    | |  ||||    || |  |    | |  ||   | |  |||||   ||||||
|| |  | ||  || ||  |   ||| /+--++++-++++++--++++++++-----++--++-++-++++++---+-+---+--+-++--++----+-+--++++----++-+--+----+-+--++---+-+\ |||||   ||||||
|| |  | ||  || ||  |   ||| ||  |||| ||||||  |||\++++-----++--++-++-++++++---/ |   |  | ||  ||    | |  ||||    || |  |    | |  ||   | || |||||   ||||||
|\-+--+-++--++-++--+---/|| ||  |||| ||||||  ||| ||||     ||  || || ||||||     |   |  | ||  ||    | |  ||||    || |  |    | |  ||   | || |||||   ||||||
|  |  | ||  || ||  |    || ||  |||| ||||||  ||| |^||     || /++-++-++++++-----+---+\ | ||  ||   /+-+--++++----++-+--+----+-+--++---+-++-+++++--\||||||
|  |  | ||  || ||  |    || ||  |||| ||||||  ||| ||||     || ||| || |\++++-----+---/| | ||  ||   || |  ||||    || |  |    | |  ||   | || |||||  |||||||
| /+--+-++--++-++--+----++-++--++++-++++++--+++-++++-----++-+++-++-+-++++\    |    | | ||  ||   || |  ||||  /-++-+--+\   ^ |  ||   | || |||||  |||||||
| ||  | ||  ||/++--+----++-++--++++-++++++--+++-++++-----++-+++-++-+-+++++----+----+-+-++--++---++-+\ ||||  | || |  ||   | |  ||   | || |||||  |||||||
| ||  | ||  |||||  | /--++-++--++++-++++++--+++-++++-----++-+++-++-+-+++++----+----+-+-++--++---++-++-++++--+-++-+--++---+-+--++-\ | || |||||  |||||||
| ||  | ||  ||||| /+-+--++-++--++++-++++++--+++-++++-----++-+++-++-+-+++++---\|    | | ||  ||   || ||/++++--+-++\|  ||   | |  || | | || |||||  |||||||
| ||  | ||  ||||| || |  || ||  |||| ||||||  ||| |||| /---++-+++-++-+-+++++---++----+-+-++--++---++-+++++++--+-++++--++---+-+-\|| | | || |||||  |||||||
| ||  | ||  ||||| || |  || ||  |||| \+++++--+++-++++-+---++-+++-++-+-+++++---++----+-+-++--++---++-+++++++--+-+/||  ||   | | ||| | | || |||||  |||||||
| ||  | ||  |||||/++-+--++-++--++++--+++++--+++-++++-+---++-+++-++-+-+++++---++----+-+-++--++---++-+++++++--+-+-++\ ||   | | ||| | | || |||||  |||||||
| ||  | ||  |||||||| |  || ||  |||\--+++++--+++-++++-+---++-+++-++-+-+/|||   ||    | | ||/-++---++-+++++++--+-+-+++-++---+-+-+++-+\| || |||||  |||||||
| ||  | ||  |||||||| |  || ||  |||   |||||  ||| |||| |   || ||| || | | |||   ||    | | ||| ||   || |||||||  | | ||| ||   | | ||| ||| || |||||  |||||||
| ||  | ||/-++++++++-+--++-++--+++---+++++--+++-++++-+---++-+++-++-+-+-+++---++----+-+-+++-++-\ || |||||||  | | |v| ||   | | ||| ||| || |||||  |||||||
| ||  | ||| |||||||| |  || ||  |||   |||||  ||| |||| |   || ||| || | | |||   ||    | | ||| || | || |||||||  | | ||| ||   | | ||| ||| || |||||  |||||||
| ||  | ||| ||||\+++-+--+/ || /+++---+++++--+++-++++-+---++-+++-++-+-+-+++---++----+-+-+++-++-+-++-+++++++--+-+-+++-++\  | | ||| ||| || |||||  |||||||
| ||  | ||| |||| ||| |  |  || ||||   |||||  ||| |||| |   || ||| || | | |||   ||    | | ||| || | || |||||||  | | ||| |||  | | ||| ||| || |||||  |||||||
| ||  | ||| |||| ||| |  |  || ||||   |||||  ||| |||| |/--++-+++-++-+-+\|||   ||    | | ||| || | || |||||||  | | ||| |||  | | ||| ||| || |||||  |||||||
| ||  | ||| |||| ||| |  |  || ||||   |||||  ||| |||| ||  || \++-++-+-+++++---++----/ | ||| || | || |||||||  | | ||| |||  | | ||| ||| || |||||  |||||||
| ||  |/+++-++++-+++\|  |  || ||||   |||||  ||| |||| ||  ||  || || | |||||   ||      | ||| || | || |||||||  | | ||| |||  | | ||| ||| || |||||  |||||||
| ||  ||||| |||\-+++++--+--++-++++---+++++--+++-++/| ||  ||  || || | |||||   ||      | ||| || | || |||||||  | | ||| |||  | | ||| ||| || |||||  |||||||
| ||  ||||| |||  |||||  |  || ||||   |||||  ||| || | ||  ||  || || | |||||   ||      | ||| || | || |||||||  | | ||| |||  | | ||| ||| || |||||  |||||||
| ||  ||||| |||  |||||  |  || ||||   |||||  ||| || | ||  ||  || || | |||||   ||      | ||| \+-+-++-+++++++--+-+-+++-+++--+-+-+++-+++-++-+++++--++++++/
| ||  ||||| |||  |||||  |  \+-++++---+++++--+++-++-+-++--++--++-++-+-+++++---++------+-+++--+-+-++-+++++++--+-+-+++-+++--+-+-+++-+++-+/ |||||  |||||| 
| ||  ||||| |||  |||||  |   | |\++---+++++--+++-++-+-++--++--++-++-+-+++++---++------+-+++--+-+-+/ |||||||  | | ||| |||  | | ||| ||| |  |||||  |||||| 
| ||  ||||| |||  |||||  |   | | |\---+++++--+++-++-+-++--++--/| || | |||||   ||      | |||  | | |  |||||||  | | ||| |||  | | ||| ||| |  |||||  |||||| 
| ||  ||||| |||  |||||  |/--+-+-+----+++++--+++-++-+-++--++\  | || | \++++---++------+-+++--+-+-+--+++++++--+-+-+++-+++--/ | ||| ||| |  |||||  |||||| 
| ||  ||||| |||  |||||  ||  | | |    |||||  ||| || | ||  |||  | || |  ||||   ||      | |||  | | |  |||||||  | | ||| |||    | ||| ||| |  |||||  |||||| 
| ||  ||||| |||  |||||  ||  | | |    |||||  ||| || | ||  |||  | || |  ||||   ||      | |||  | | |  |||||||  \-+-+++-+/|    | ||| ||| |  |||||  |||||| 
| ||  ||||| |||  |||||  ||  | | |    ||\++--+++-++-+-++--/||  | || |  ||||   ||      | |||  | | \--+++++++----+-+++-+-+----+-+++-+++-+--+++++--/||||| 
| ||  ||||| |||  |||||  ||  | | |    || ||  ||| || | ||   ||  | || |  ||||   ||      | |||  | |    |||||||    | ||| | |    | ||| ||| |  |||||   ||||| 
| ||  ||||| |||  |||||  ||  |/+-+----++-++--+++-++-+-++---++--+-++-+--++++---++------+-+++--+-+----+++++++--\ | ||| | |    | ||| ||| |  |||||   ||||| 
| ||  ||||| |||  |||||  || /+++-+----++-++--+++-++-+-++---++--+-++-+--++++---++------+-+++--+-+\   |||||||  | | ||| | |    | ||| ||| |  |||||   ||||| 
| ||  ||||| |||  |||||  || |||| |    || ||  ||| || | ||   ||  | || |  ||||   || /----+-+++--+-++---+++++++--+-+-+++-+-+----+-+++-+++-+--+++++---+++++\
| ||  ||||| |||  |||||  || |||| |    || ||  ||| || | ||/--++--+-++-+--++++---++-+----+-+++--+-++---+++++++\ | | ||| | |    | ||| ||| |  |||||   ||||||
| ||  ||||| |||  |||||  || |||| |/---++-++--+++-++-+\|||  ||  | |\-+--++++---++-+----+-+++--+-++---+++++/|| | | ||| | |    | ||| ||| |  |||||   ||||||
| ||/-+++++-+++--+++++--++-++++-++\  || ||  ||| || |||||  ||  | |  |  ||||   || |    | |||  | ||   ||\++-++-+-+-/|| | |    | ||| ||| |  |||||   ||||||
| ||| ||||| |||  |||||  || |||| |||  || ||  ||\-++-+++++--++--+-+--+--++++---++-+----+-+++--+-++---++-+/ || | | /++-+-+--\ | ||| ||| |  |||||   ||||||
| ||| ||||| |||  |||||  || |||| |||  || ||  ||  || |||||  ||  | |  |  ||||   || |    \-+++--+-++---++-+--++-+-+-+++-+-+--+-+-+++-+++-+--/||||   ||||||
| ||| ||||| |||  |||||  || |||| |||  || ||  || /++-+++++--++--+-+--+--++++---++-+------+++\ | ||   || |  || | | ||| | |  | | ||| ||| |   ||||   ||||||
| |\+-+++++-+++--+++++--/| |||| |||  || ||  || ||| |||||  ||  | |  |  ||||   || |      |||| | ||   || \--++-+-+-+/| | |  | | ||| ||| \---++++---/|||||
| | | ||||| |||  |||||   | |||| |||  || ||  || ||| |||||  ||  | |  |  ||||   || |      |||| | ||   ||    || | | | | | |  | | ||^ |v|     ||||    |||||
| | | ||||| |||  ||\++---+-++++-+++--++-++--++-+++-+++++--++--+-+--+--++++---++-+------++++-+-++---/|    || | | | | | |  | | ||| |||     ||||    |||||
| | | ||||| |||  || ||   | |||| |||  || ||  || ||| |||||  ||  | |  |  ||||   || |      |||| | ||    |    || | | | | | |  | | ||| |||     ||||    |||||
| | | ||||| |||  || ||   | |||| |||  |\-++--++-+++-+++++--++--+-+--+--++++---++-+------++++-+-++----+----++-+-+-+-+-+-+--+-+-+++-+++-----/|||    |||||
| | | ||||| |||  || ||   | |||| |||  |  ||  || ||| ||||\--++--+-+--+--++++---++-+------++++-+-++----+----+/ | | | | | |  | | ||| |||      |||    |||||
| | | ||||| |||  || ||   | |||| |||  |  ||  || ||| ||||   \+--+-+--+--++++---++-+------++++-+-++----+----+--+-+-+-+-+-+--+-+-+++-+++------/||    |||||
| | | ||||| |||  || ||   | |||| |||  |  || /++-+++-++++----+--+-+\ |  ||||   || |      ||||/+-++----+----+--+-+-+-+-+-+--+-+-+++-+++---\   ||    |||||
| | | ||||| |||/-++-++---+-++++-+++--+--++-+++-+++-++++----+--+-++-+--++++---++-+\     |||||| ||    |    |  | | | |/+-+--+-+-+++\|||   |   ||    |||||
| | | ||||| |||| || ||   | |||| |||  |  || ||| ||| \+++----+--+-++-+--++++---++-++-----+/|||| ||    |    |  | | | ||| |  | | |||||||   |   ||    |||||
| | | |||\+-++++-++-++---+-+/|| |||  |  || ||| |||  |||    |  | || |  ||||   || ||     \-++++-++----+----+--+-+-+-+++-+--+-/ |||||||   |   ||    |||||
| | | ||| \-++++-++-++---+-+-++-+++--+--++-+++-+++--+++----+--+-++-+--++++---++-++-------++++-/|    |    |  | | | ||| |  |   |||||||   |   ||    |||||
| | | \++---++++-++-++---+-+-++-+++--+--+/ ||| |||  |||    |  | || |  ||||   ||/++-------++++--+----+----+--+-+-+-+++-+--+---+++++++-\ |   ||    |||||
| | |  ||   |||| || ||   | | || |||  |  \--+++-+++--+++----+--+-++-+--++++---+++++-------++++--+----+----+--+-/ | ||| |  |   ||||||| | |   ||    |||||
| | |  ||   |||| || ||   | | || |||  \-----+++-+++--+++----+--+-++-+--++++---+++++-------++++--+----+----+--+---+-+++-+--+---+++++++-+-+---++----/||||
| | |  ||   ^||| || ||   | | || |||        ||| |||  |||    |  | || |  ||||   |||||       ||||  |    |    |  |   | ||| |  |   ||||||| | |   ||     ||||
| | |  ||   \+++-++-++---+-+-++-+++--------+++-+++--+++----+--+-++-+--++++---+++++-------++++--+----+----+--+---+-++/ |  |   ||||||| | |   ||     ||||
| | |  ||    ||| || ||   | | || |||      /-+++-+++--+++----+--+-++-+--++++---+++++-------++++--+----+----+--+---+\||  |  |   ||\++++-+-+---++-----+/||
| | |  ||    ||| || ||   | | || |||/-----+-+++-+++\ |||  /-+--+-++-+--++++---+++++-------++++--+----+----+--+---++++-\|  |   || |||| | |   ||     | ||
| | |  \+----+++-++-/|   | | || ||||     | ||\-++++-+++--+-+--+-++-/  ||||   |||||       ||||  |    |    |  |   ||||/++--+---++\|||| | |   ||     | ||
| | |   |    ||| ||  \---+-+-++-++++-----+-++--++++-+++--+-+--+-++----++++---+++++-------++++--+----+----+--+---+++++++--+---++++/|| | |   ||     | ||
| | |   |    ||| ||      | | || ||||     | ||  |||| |||  | |  |/++----++++\  |||||       ||||  |    |    |  |   |||||||  |   |||| || | |   ||     | ||
| | |   |    ||| ||      | | || ||||     | ||  |||| |||  | |  |||| /--+++++--+++++-------++++--+----+----+--+<--+++++++--+---++++-++-+-+---++--\  | ||
| | |   |    ||| ||      | | || ||||     | ||  \+++-+++--+-+--++++-+--+++++--+++++-------+/||  |    |    |  |   |||\+++--+---+++/ || | |   ||  |  | ||
| | |   \----+++-++->----+-+-++-/\++-----+-++---+++-/||  | |  |||| |  |||||  |||||       | ||  |    |    |  |   ||| |||  |   |||  || | |   ||  |  | ||
| | |        ||| ||      | | ||   ||     | ||   |||  \+--+-+--++++-+--+++++--+++++-->----+-++--+----+----+--+---+++-+++--+---/||  || | |   ||  |  | ||
| | |        ||| ||      | | \+---++-----+-++---+++---+--+-+--++++-+--+++++--+++++-------+-++--+----+----+--/   ||| |||  |    ||  || | |   ||  |  | ||
| | |        ||| ||      | |  |   |\-----+-++---++//--+--+-+-\|||| |  |||||  |||||       \-++--+----+----+------+++-+++--+----++--/| | |   ||  |  | ||
| | |        ||| ||      | |  |   |      | ||   || |  |  | | ||||| |  |||||  |||||         ||  |    |    |      ||| |||  |    ||/--+-+-+---++-\|  | ||
\-+-+--------/|| ||      | |  |   |      | ||   || |  |  | | ||||| |  |||||  ||\++---------++--+----+----+------+++<+++--+----+++--+-/ |   || ||  | ||
  | |         || |\------+-+--+---+------+-++---++-+--+--+-+-+++++-+--+++++--/| ||         \+--+----+----+------+++-+++--+----+++--+---/   || ||  | ||
  | |         || | /-----+-+--+---+------+-++\  || |  |  | | |||\+-+--+++++---+-++----------+--+----+----/      ||| |||  |    |||  |       || ||  | ||
  | |         || | |     | |  |   |      | |||  || |  |  | | ||| | |  |||||   | \+----------+--+----+-----------+++-+++--+----+++--+-------++-++--+-+/
  | |         || | |     | |  |   |      | |||  || |  \--+-+-+++-+-+--/|\++---+--+----------+--+----+------>----+++-+++--+----+++--+-------++-++--/ | 
  | \---------++-+-+-----+-+--+---/      | |||  || |     | | |\+-+-+---+-++---+--+----------/  |    |           ||| |||  |    |||  |       || ||    | 
  |           || | |     | \--+----------+-+++--++-+-----+-+-+-+-+-+---+-++---+--+-------------/    |           \++-+++--/    |||  |       || ||    | 
  \-----------++-+-+-----+----+----------+-+++--++-+-----+-+-+-+-+-+---+-/|   |  |                  |            || |||       |||  |       || ||    | 
              || | |     |    |          | \++--++-+-----+-+-+-+-/ \---+--+---+--+------------------+------------++-+++-------+++--+-------++-+/    | 
              || | |     |    |          \--++--++-+-----+-+-+-+-------+--+---+--+------------------+------------/| |||       |||  |       || |     | 
              || | |     |    |             \+--++-+-----+-+-+-+-------/  |   |  |                  |             | |||       |||  |       || |     | 
              || | |     |    |              |  || \-----+-+-/ |          |   \--+------------------+-------------+-+++-------+++--+-------/| |     | 
              || | \-----+----+--------------/  |\-------+-+---+----------+------+------------------+-------------+-+++-------+++--/        | |     | 
              || |       \----+-----------------+--------+-/   |          |      |                  |             | |||       |||           | |     | 
              || |            |                 |        |     |          |      |                  |             | |||       |||           | |     | 
              || |            |                 |        |     |          |      |                  |             | |||       |||           | |     | 
              || \------------+-----------------+--------+-----+----------+------+------------------+-------------/ |||       |||           | |     | 
              ||              |                 |        \-----+----------+------+------------------+---------------+/|       \++-----------+-+-----/ 
              ||              |                 |              |          |      |                  |               | |        ||           | |       
              ||              |                 \--------------+----------+------+------------------+---------------+-+--------++-----------/ |       
              |\---<----------+--------------------------------+----------+------/                  |               | |        ||             |       
              |               |                                \----------/                         |               \-+--------/\-------------/       
              |               \---------------------------------------------------------------------+-----------------/                               
              \-------------------------------------------------------------------------------------/                                                 ");

        }
    }
}
